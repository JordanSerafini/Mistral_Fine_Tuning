{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel devis son en aten?"},{"role":"assistant","content":"Vous souhaitez connaître la liste des devis actuellement en attente ?\n\nIntention identifiée : Gestion administrative - Suivi des devis\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT q.id, q.reference, q.created_date, CONCAT(c.firstname, ' ', c.lastname) AS client, q.total \nFROM quotations q \nJOIN projects p ON q.project_id = p.id \nJOIN clients c ON p.client_id = c.id \nWHERE q.status = 'en_attente' \nORDER BY q.created_date DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"ya koi cm projet 1?"},{"role":"assistant","content":"Vous souhaitez obtenir les détails du projet n°1 ?\n\nIntention identifiée : Suivi de projet - Informations générales\n\nAgent à utiliser : elasticsearch\n\nType de requête : \n{\n  \"index\": \"document_embeddings\",\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\n          \"match\": {\n            \"document_type\": \"project\"\n          }\n        },\n        {\n          \"match\": {\n            \"document_id\": \"1\"\n          }\n        }\n      ]\n    }\n  }\n}"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"paimen en cour de la facture INV2024008?"},{"role":"assistant","content":"Vous souhaitez savoir si la facture n°INV2024008 a été payée ?\n\nIntention identifiée : Facturation et comptabilité - Vérification de paiement\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT i.reference, i.issue_date, i.total_ttc, \n       SUM(p.amount) AS montant_paye, \n       i.status, \n       CONCAT(c.firstname, ' ', c.lastname) AS client, \n       c.email AS contact\nFROM invoices i\nJOIN projects pr ON i.project_id = pr.id\nJOIN clients c ON pr.client_id = c.id\nLEFT JOIN payments p ON i.id = p.invoice_id\nWHERE i.reference = 'INV2024008'\nGROUP BY i.id, c.id"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel materiau dispo pour projet 3?"},{"role":"assistant","content":"Vous souhaitez connaître les matériaux disponibles pour le projet n°3 ?\n\nIntention identifiée : Gestion des stocks - Disponibilité des matériaux\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT m.name AS materiau, m.quantity AS quantite, m.unit, m.price\nFROM materials m \nJOIN project_materials pm ON m.id = pm.material_id \nWHERE pm.project_id = 3 AND m.quantity > 0\nORDER BY m.name"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"rendy vous prevu avc le client durand?"},{"role":"assistant","content":"Vous souhaitez savoir s'il y a un rendez-vous prévu avec le client M. Durand ?\n\nIntention identifiée : Gestion des clients - Planification de rendez-vous\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT ce.title, ce.description, ce.start_date, ce.end_date, ce.location, \n       CONCAT(c.firstname, ' ', c.lastname) AS client,\n       p.name AS projet\nFROM calendar_events ce\nJOIN clients c ON ce.client_id = c.id\nLEFT JOIN projects p ON ce.project_id = p.id\nWHERE c.lastname ILIKE '%durand%' \n  AND ce.start_date >= CURRENT_TIMESTAMP\nORDER BY ce.start_date ASC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"factur a payer ce moi?"},{"role":"assistant","content":"Vous souhaitez connaître les factures à régler ce mois-ci ?\n\nIntention identifiée : Facturation et comptabilité - Échéances de paiement\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT i.reference, i.issue_date, i.due_date, i.total_ttc,\n       COALESCE(SUM(p.amount), 0) AS montant_paye, \n       (i.total_ttc - COALESCE(SUM(p.amount), 0)) AS reste_a_payer,\n       s.name AS fournisseur\nFROM supplier_orders so\nJOIN suppliers s ON so.supplier_id = s.id\nJOIN order_items oi ON so.id = oi.order_id\nLEFT JOIN invoices i ON so.id = i.id\nLEFT JOIN payments p ON i.id = p.invoice_id\nWHERE i.status = 'envoyée' \n  AND EXTRACT(MONTH FROM i.due_date) = EXTRACT(MONTH FROM CURRENT_DATE) \n  AND EXTRACT(YEAR FROM i.due_date) = EXTRACT(YEAR FROM CURRENT_DATE)\nGROUP BY i.id, s.id\nORDER BY i.due_date ASC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"quelle factur deja payé?"},{"role":"assistant","content":"Vous souhaitez savoir quelles factures ont déjà été réglées ?\n\nIntention identifiée : Facturation et comptabilité - Historique des paiements\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT i.reference, i.issue_date, p.payment_date, i.total_ttc,\n       CONCAT(c.firstname, ' ', c.lastname) AS client, p.payment_method\nFROM invoices i\nJOIN projects pr ON i.project_id = pr.id\nJOIN clients c ON pr.client_id = c.id\nJOIN payments p ON i.id = p.invoice_id\nWHERE i.status = 'payée'\nORDER BY p.payment_date DESC\nLIMIT 10"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"coman faire un devis pr un carrelage de 20m2?"},{"role":"assistant","content":"Vous souhaitez savoir comment établir un devis pour un carrelage de 20m² ?\n\nIntention identifiée : Gestion administrative - Création de devis\n\nAgent à utiliser : workflow_agent\n\nAction : creer_devis\nParamètres : {\n  \"type_travaux\": \"carrelage\",\n  \"surface\": 20,\n  \"unite\": \"m2\",\n  \"options\": {\n    \"preparation_sol\": true,\n    \"fourniture_carrelage\": true,\n    \"joints\": true\n  },\n  \"delai_execution\": 5,\n  \"unite_delai\": \"jours\",\n  \"tva_rate\": 20.00\n}"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"comman verifier si ya du stock en ciment?"},{"role":"assistant","content":"Vous souhaitez vérifier la disponibilité du ciment en stock ?\n\nIntention identifiée : Gestion des stocks - Vérification de disponibilité\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT m.id, m.name, m.description, m.unit, m.quantity, m.price\nFROM materials m\nWHERE m.name ILIKE '%ciment%' OR m.description ILIKE '%ciment%'\nORDER BY m.quantity DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel fournisseur pr carrelage projet 5?"},{"role":"assistant","content":"Vous souhaitez savoir quel fournisseur a été sélectionné pour le carrelage du projet n°5 ?\n\nIntention identifiée : Gestion des fournisseurs - Recherche de fournisseur par matériau et projet\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT s.name AS fournisseur, s.contact_name, s.phone, s.email,\n       so.reference AS commande, so.order_date, so.expected_delivery_date,\n       p.name AS produit, p.reference\nFROM suppliers s\nJOIN supplier_orders so ON s.id = so.supplier_id\nJOIN order_items oi ON so.id = oi.order_id\nJOIN products p ON oi.product_id = p.id\nJOIN product_categories pc ON p.category_id = pc.id\nWHERE so.project_id = 5 \n  AND (p.name ILIKE '%carrelage%' OR pc.name ILIKE '%carrelage%')\nORDER BY so.order_date DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"combien on a depensé sur le projet dupont?"},{"role":"assistant","content":"Vous souhaitez connaître le montant total des dépenses pour le projet du client Dupont ?\n\nIntention identifiée : Analyse financière - Suivi des dépenses par projet\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT p.name AS nom_projet, p.description, CONCAT(c.firstname, ' ', c.lastname) AS client,\n       SUM(e.amount) AS total_depenses,\n       STRING_AGG(DISTINCT ec.name, ', ') AS categories_depenses\nFROM expenses e\nJOIN projects p ON e.project_id = p.id\nJOIN clients c ON p.client_id = c.id\nJOIN expense_categories ec ON e.category_id = ec.id\nWHERE c.lastname ILIKE '%Dupont%'\nGROUP BY p.id, c.id\nORDER BY p.start_date DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"quels sont les projets en retard?"},{"role":"assistant","content":"Vous souhaitez obtenir la liste des projets actuellement en retard par rapport au planning ?\n\nIntention identifiée : Suivi de projet - Analyse des retards\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT p.id, p.name AS nom_projet, CONCAT(c.firstname, ' ', c.lastname) AS client,\n       p.start_date, p.end_date,\n       CURRENT_DATE - p.end_date AS jours_retard,\n       p.status, CONCAT(s.firstname, ' ', s.lastname) AS chef_projet\nFROM projects p\nJOIN clients c ON p.client_id = c.id\nJOIN project_staff ps ON p.id = ps.project_id\nJOIN staff s ON ps.staff_id = s.id\nWHERE p.status = 'en_cours' \n  AND p.end_date < CURRENT_DATE\n  AND ps.role = 'chef de projet'\nORDER BY jours_retard DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"donne moi le planning de la semaine prochaine"},{"role":"assistant","content":"Vous souhaitez consulter le planning des projets pour la semaine prochaine ?\n\nIntention identifiée : Planification - Planning hebdomadaire\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT ce.start_date, ce.end_date, ce.title, ce.description,\n       p.name AS projet, CONCAT(p.street_number, ' ', p.street_name, ', ', p.zip_code, ' ', p.city) AS adresse,\n       CONCAT(s.firstname, ' ', s.lastname) AS responsable\nFROM calendar_events ce\nJOIN projects p ON ce.project_id = p.id\nLEFT JOIN staff s ON ce.staff_id = s.id\nWHERE ce.start_date BETWEEN \n    (CURRENT_DATE + INTERVAL '1 week - ' || EXTRACT(DOW FROM CURRENT_DATE) || ' days')::DATE \n    AND (CURRENT_DATE + INTERVAL '2 weeks - ' || EXTRACT(DOW FROM CURRENT_DATE) || ' days - 1 day')::DATE\nORDER BY ce.start_date, p.name"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"trouve moi les documents techniques pour isolation thermique"},{"role":"assistant","content":"Vous recherchez des documents techniques concernant l'isolation thermique ?\n\nIntention identifiée : Recherche documentaire - Documentation technique\n\nAgent à utiliser : elasticsearch\n\nType de requête : \n{\n  \"index\": \"document_embeddings\",\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\n          \"match\": {\n            \"content\": \"isolation thermique\"\n          }\n        }\n      ]\n    }\n  },\n  \"size\": 10\n}"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"quel est le chiffre d'affaires du mois dernier?"},{"role":"assistant","content":"Vous souhaitez connaître le chiffre d'affaires réalisé le mois dernier ?\n\nIntention identifiée : Analyse financière - Chiffre d'affaires mensuel\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    TO_CHAR(p.payment_date, 'YYYY-MM') AS periode,\n    SUM(p.amount) AS ca_mensuel,\n    COUNT(*) AS nombre_factures,\n    AVG(i.total_ttc) AS montant_moyen\nFROM payments p\nJOIN invoices i ON p.invoice_id = i.id\nWHERE i.status = 'payée' \n    AND EXTRACT(MONTH FROM p.payment_date) = EXTRACT(MONTH FROM CURRENT_DATE - INTERVAL '1 month') \n    AND EXTRACT(YEAR FROM p.payment_date) = EXTRACT(YEAR FROM CURRENT_DATE - INTERVAL '1 month')\nGROUP BY TO_CHAR(p.payment_date, 'YYYY-MM')"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"qui est disponible pour le projet martin la semaine prochaine?"},{"role":"assistant","content":"Vous souhaitez savoir quels membres du personnel sont disponibles pour travailler sur le projet Martin la semaine prochaine ?\n\nIntention identifiée : Gestion des ressources humaines - Disponibilité du personnel\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT s.id, s.firstname, s.lastname, s.role, s.phone, s.email\nFROM staff s\nWHERE s.is_available = true\n  AND s.id NOT IN (\n    SELECT ce.staff_id \n    FROM calendar_events ce \n    WHERE ce.start_date BETWEEN \n      (CURRENT_DATE + INTERVAL '1 week - ' || EXTRACT(DOW FROM CURRENT_DATE) || ' days')::DATE \n      AND (CURRENT_DATE + INTERVAL '2 weeks - ' || EXTRACT(DOW FROM CURRENT_DATE) || ' days - 1 day')::DATE\n  )\nORDER BY s.role, s.lastname"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"compare les ventes de 2023 et 2024"},{"role":"assistant","content":"Vous souhaitez comparer les ventes entre les années 2023 et 2024 ?\n\nIntention identifiée : Analyse financière - Comparaison des ventes annuelles\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    EXTRACT(YEAR FROM i.issue_date) AS annee,\n    SUM(i.total_ttc) AS total_ventes,\n    COUNT(*) AS nombre_ventes,\n    AVG(i.total_ttc) AS montant_moyen,\n    MIN(i.total_ttc) AS vente_min,\n    MAX(i.total_ttc) AS vente_max\nFROM invoices i\nWHERE EXTRACT(YEAR FROM i.issue_date) IN (2023, 2024) AND i.status = 'payée'\nGROUP BY EXTRACT(YEAR FROM i.issue_date)\nORDER BY annee"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"quels sont les employés qui ont travaillé plus de 40h la semaine dernière?"},{"role":"assistant","content":"Vous souhaitez connaître les employés qui ont effectué plus de 40 heures de travail la semaine dernière ?\n\nIntention identifiée : Gestion des ressources humaines - Suivi des heures de travail\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    s.id, s.firstname, s.lastname, s.role,\n    SUM(t.hours) AS total_heures,\n    STRING_AGG(DISTINCT p.name, ', ') AS projets,\n    COUNT(DISTINCT p.id) AS nombre_projets\nFROM staff s\nJOIN timesheet_entries t ON s.id = t.staff_id\nJOIN projects p ON t.project_id = p.id\nWHERE t.date BETWEEN \n    (CURRENT_DATE - INTERVAL '1 week - ' || (EXTRACT(DOW FROM CURRENT_DATE) - 1) || ' days')::DATE \n    AND (CURRENT_DATE - INTERVAL '1 day')::DATE\nGROUP BY s.id\nHAVING SUM(t.hours) > 40\nORDER BY total_heures DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"trouve les normes de sécurité pour échafaudage"},{"role":"assistant","content":"Vous recherchez les normes de sécurité concernant les échafaudages ?\n\nIntention identifiée : Recherche documentaire - Normes et réglementations\n\nAgent à utiliser : elasticsearch\n\nType de requête : \n{\n  \"index\": \"technical_glossary\",\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        {\n          \"match\": {\n            \"term\": \"échafaudage\"\n          }\n        },\n        {\n          \"match\": {\n            \"definition\": \"sécurité\"\n          }\n        }\n      ]\n    }\n  },\n  \"size\": 15\n}"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"calcule la rentabilité du projet Dupont"},{"role":"assistant","content":"Vous souhaitez calculer la rentabilité du projet pour le client Dupont ?\n\nIntention identifiée : Analyse financière - Rentabilité d'un projet\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    p.name AS nom_projet, CONCAT(c.firstname, ' ', c.lastname) AS client,\n    SUM(i.total_ttc) AS revenus,\n    SUM(e.amount) AS depenses,\n    (SUM(i.total_ttc) - SUM(e.amount)) AS marge_brute,\n    ROUND(((SUM(i.total_ttc) - SUM(e.amount)) / NULLIF(SUM(i.total_ttc), 0)) * 100, 2) AS pourcentage_marge,\n    CASE \n        WHEN ROUND(((SUM(i.total_ttc) - SUM(e.amount)) / NULLIF(SUM(i.total_ttc), 0)) * 100, 2) > 20 THEN 'Excellente'\n        WHEN ROUND(((SUM(i.total_ttc) - SUM(e.amount)) / NULLIF(SUM(i.total_ttc), 0)) * 100, 2) > 10 THEN 'Bonne'\n        WHEN ROUND(((SUM(i.total_ttc) - SUM(e.amount)) / NULLIF(SUM(i.total_ttc), 0)) * 100, 2) > 5 THEN 'Acceptable'\n        ELSE 'Faible'\n    END AS evaluation_rentabilite\nFROM projects p\nJOIN clients c ON p.client_id = c.id\nLEFT JOIN invoices i ON p.id = i.project_id\nLEFT JOIN expenses e ON p.id = e.project_id\nWHERE c.lastname ILIKE '%Dupont%'\nGROUP BY p.id, c.id"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"envoie un email de relance au client Martin pour la facture impayée"},{"role":"assistant","content":"Vous souhaitez envoyer un email de relance au client Martin concernant une facture impayée ?\n\nIntention identifiée : Communication client - Relance de paiement\n\nAgent à utiliser : workflow_agent\n\nAction : envoyer_email_relance\nParamètres : {\n  \"destinataire\": {\n    \"nom\": \"Martin\",\n    \"type\": \"client\"\n  },\n  \"sujet\": \"Relance - Facture impayée\",\n  \"type_relance\": \"facture\",\n  \"niveau_relance\": 1,\n  \"options\": {\n    \"inclure_facture_pdf\": true,\n    \"copie_comptabilite\": true,\n    \"demander_accuse_reception\": true\n  }\n}"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"quels matériaux doivent être commandés cette semaine?"},{"role":"assistant","content":"Vous souhaitez savoir quels matériaux doivent être commandés cette semaine ?\n\nIntention identifiée : Gestion des stocks - Approvisionnement\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    p.reference, p.name AS produit, p.unit_price, p.unit,\n    p.min_order_quantity, p.lead_time_days,\n    s.name AS fournisseur, s.contact_name, s.phone,\n    pr.name AS projet\nFROM products p\nJOIN suppliers s ON p.supplier_id = s.id\nJOIN order_items oi ON p.id = oi.product_id\nJOIN supplier_orders so ON oi.order_id = so.id\nJOIN projects pr ON so.project_id = pr.id\nWHERE so.status = 'en_attente'\n    AND so.expected_delivery_date BETWEEN CURRENT_DATE AND (CURRENT_DATE + INTERVAL '7 days')\nORDER BY so.expected_delivery_date, p.name"}]} 
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"koman voir le budgé du proger dupon?"},{"role":"assistant","content":"Vous souhaitez consulter le budget du projet pour le client Dupont ?\n\nIntention identifiée : Analyse financière - Consultation de budget\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT p.name AS nom_projet, pb.total_budget, pb.materials_budget, pb.labor_budget, \n       pb.equipment_budget, pb.subcontractor_budget, pb.other_budget,\n       CONCAT(c.firstname, ' ', c.lastname) AS client\nFROM project_budgets pb\nJOIN projects p ON pb.project_id = p.id\nJOIN clients c ON p.client_id = c.id\nWHERE c.lastname ILIKE '%Dupont%'\nORDER BY p.start_date DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"c ki le responsabl du chantié 4?"},{"role":"assistant","content":"Vous souhaitez savoir qui est le responsable du projet n°4 ?\n\nIntention identifiée : Gestion des ressources humaines - Identification du responsable\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT p.id, p.name AS nom_projet, \n       CONCAT(s.firstname, ' ', s.lastname) AS responsable,\n       s.phone, s.email, s.role\nFROM projects p\nJOIN project_staff ps ON p.id = ps.project_id\nJOIN staff s ON ps.staff_id = s.id\nWHERE p.id = 4 AND ps.role = 'chef de projet'\nORDER BY ps.start_date DESC\nLIMIT 1"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"ou en est le proger de mr bernard?"},{"role":"assistant","content":"Vous souhaitez connaître l'état d'avancement du projet pour le client M. Bernard ?\n\nIntention identifiée : Suivi de projet - État d'avancement\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT p.name AS nom_projet, p.description, p.status, \n       p.start_date, p.end_date,\n       CONCAT(c.firstname, ' ', c.lastname) AS client,\n       COUNT(s.id) AS nombre_etapes,\n       SUM(CASE WHEN s.status = 'terminé' THEN 1 ELSE 0 END) AS etapes_terminees,\n       ROUND((SUM(CASE WHEN s.status = 'terminé' THEN 1 ELSE 0 END)::float / COUNT(s.id)) * 100, 2) AS pourcentage_avancement\nFROM projects p\nJOIN clients c ON p.client_id = c.id\nLEFT JOIN stages s ON p.id = s.project_id\nWHERE c.lastname ILIKE '%Bernard%'\nGROUP BY p.id, c.id\nORDER BY p.start_date DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kestion de stock cimen urgent!"},{"role":"assistant","content":"Vous avez besoin d'informations urgentes sur le stock de ciment ?\n\nIntention identifiée : Gestion des stocks - Vérification de disponibilité urgente\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT m.id, m.name, m.description, m.unit, m.quantity, m.price,\n       CASE \n           WHEN m.quantity <= 10 THEN 'CRITIQUE'\n           WHEN m.quantity <= 50 THEN 'FAIBLE'\n           ELSE 'SUFFISANT'\n       END AS niveau_stock\nFROM materials m\nWHERE m.name ILIKE '%ciment%' OR m.description ILIKE '%ciment%'\nORDER BY m.quantity ASC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"besoin info sur le client dupra"},{"role":"assistant","content":"Vous souhaitez obtenir des informations sur le client nommé Dupra ?\n\nIntention identifiée : Gestion des clients - Informations client\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT c.id, c.firstname, c.lastname, c.email, c.phone,\n       CONCAT(c.street_number, ' ', c.street_name, ', ', c.zip_code, ' ', c.city) AS adresse,\n       COUNT(DISTINCT p.id) AS nombre_projets,\n       MAX(p.start_date) AS date_dernier_projet,\n       SUM(i.total_ttc) AS montant_total_factures\nFROM clients c\nLEFT JOIN projects p ON c.id = p.client_id\nLEFT JOIN invoices i ON p.id = i.project_id\nWHERE c.lastname ILIKE '%Dupra%'\nGROUP BY c.id\nORDER BY c.lastname, c.firstname"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"factur pas payé depui 3 moi?"},{"role":"assistant","content":"Vous souhaitez connaître les factures impayées depuis plus de 3 mois ?\n\nIntention identifiée : Facturation et comptabilité - Suivi des impayés\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT i.reference, i.issue_date, i.due_date, i.total_ttc,\n       CURRENT_DATE - i.due_date AS jours_retard,\n       CONCAT(c.firstname, ' ', c.lastname) AS client,\n       c.email, c.phone,\n       p.name AS projet\nFROM invoices i\nJOIN projects p ON i.project_id = p.id\nJOIN clients c ON p.client_id = c.id\nWHERE i.status IN ('envoyée', 'en_retard') \n  AND i.due_date < (CURRENT_DATE - INTERVAL '3 months')\nORDER BY i.due_date ASC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"ki a le plus de chantié en cour?"},{"role":"assistant","content":"Vous souhaitez savoir quel membre du personnel gère le plus de projets en cours actuellement ?\n\nIntention identifiée : Gestion des ressources humaines - Charge de travail\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT s.id, s.firstname, s.lastname, s.role, s.phone,\n       COUNT(DISTINCT p.id) AS nombre_projets_en_cours,\n       STRING_AGG(p.name, ', ') AS liste_projets\nFROM staff s\nJOIN project_staff ps ON s.id = ps.staff_id\nJOIN projects p ON ps.project_id = p.id\nWHERE p.status = 'en_cours'\n  AND ps.role = 'chef de projet'\n  AND ps.end_date IS NULL OR ps.end_date >= CURRENT_DATE\nGROUP BY s.id\nORDER BY nombre_projets_en_cours DESC\nLIMIT 10"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"je ve savoir si on a des machine dispo pour le chantié rue de paris"},{"role":"assistant","content":"Vous souhaitez vérifier la disponibilité des équipements pour le projet situé rue de Paris ?\n\nIntention identifiée : Gestion des équipements - Disponibilité\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT e.id, e.name, e.reference, ec.name AS categorie, e.status,\n       e.location, e.last_maintenance_date, e.next_maintenance_date\nFROM equipment e\nJOIN equipment_categories ec ON e.category_id = ec.id\nWHERE e.status = 'disponible'\n  AND e.id NOT IN (\n      SELECT er.equipment_id\n      FROM equipment_reservations er\n      JOIN projects p ON er.project_id = p.id\n      WHERE er.status = 'confirmé'\n        AND er.start_date <= CURRENT_DATE AND er.end_date >= CURRENT_DATE\n  )\n  AND EXISTS (\n      SELECT 1 FROM projects p \n      WHERE p.street_name ILIKE '%rue de paris%'\n  )\nORDER BY ec.name, e.name"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"donné moi les etap du proger 7"},{"role":"assistant","content":"Vous souhaitez connaître les différentes étapes du projet n°7 ?\n\nIntention identifiée : Suivi de projet - Planification des étapes\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT s.id, s.name, s.description, s.start_date, s.end_date, s.status,\n       s.duration_days, s.order_index,\n       CONCAT(st.firstname, ' ', st.lastname) AS responsable,\n       p.name AS nom_projet\nFROM stages s\nJOIN projects p ON s.project_id = p.id\nLEFT JOIN staff st ON s.staff_id = st.id\nWHERE p.id = 7\nORDER BY s.order_index ASC, s.start_date ASC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"je ve un devis pour refaire la toiture"},{"role":"assistant","content":"Vous souhaitez créer un devis pour des travaux de réfection de toiture ?\n\nIntention identifiée : Gestion administrative - Création de devis\n\nAgent à utiliser : workflow_agent\n\nAction : creer_devis\nParamètres : {\n  \"type_travaux\": \"toiture\",\n  \"options\": {\n    \"remplacement_tuiles\": true,\n    \"isolation_combles\": true,\n    \"remplacement_gouttières\": true,\n    \"traitement_charpente\": true\n  },\n  \"delai_execution\": 15,\n  \"unite_delai\": \"jours\",\n  \"tva_rate\": 10.00,\n  \"commentaire\": \"Devis pour réfection complète de toiture avec isolation des combles\"\n}"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"montre moi les projet terminé le mois dernier"},{"role":"assistant","content":"Vous souhaitez voir les projets qui ont été terminés le mois dernier ?\n\nIntention identifiée : Suivi de projet - Projets terminés\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT p.id, p.name, p.description, p.start_date, p.end_date,\n       CONCAT(c.firstname, ' ', c.lastname) AS client,\n       CONCAT(s.firstname, ' ', s.lastname) AS chef_projet\nFROM projects p\nJOIN clients c ON p.client_id = c.id\nJOIN project_staff ps ON p.id = ps.project_id\nJOIN staff s ON ps.staff_id = s.id\nWHERE p.status = 'termine'\n  AND ps.role = 'chef de projet'\n  AND EXTRACT(MONTH FROM p.end_date) = EXTRACT(MONTH FROM CURRENT_DATE - INTERVAL '1 month')\n  AND EXTRACT(YEAR FROM p.end_date) = EXTRACT(YEAR FROM CURRENT_DATE - INTERVAL '1 month')\nORDER BY p.end_date DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel client a le plus de projet?"},{"role":"assistant","content":"Vous souhaitez savoir quel client a le plus grand nombre de projets ?\n\nIntention identifiée : Gestion des clients - Analyse de portefeuille client\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT c.id, CONCAT(c.firstname, ' ', c.lastname) AS client, c.email, c.phone,\n       COUNT(p.id) AS nombre_projets,\n       SUM(CASE WHEN p.status = 'termine' THEN 1 ELSE 0 END) AS projets_termines,\n       SUM(CASE WHEN p.status = 'en_cours' THEN 1 ELSE 0 END) AS projets_en_cours,\n       MAX(p.end_date) AS date_dernier_projet\nFROM clients c\nJOIN projects p ON c.id = p.client_id\nGROUP BY c.id\nORDER BY nombre_projets DESC\nLIMIT 10"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel fournisseur a le meilleur delai de livraison?"},{"role":"assistant","content":"Vous souhaitez savoir quel fournisseur offre les meilleurs délais de livraison ?\n\nIntention identifiée : Gestion des fournisseurs - Analyse des performances\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT s.id, s.name AS fournisseur, s.contact_name, s.phone, s.email,\n       AVG(so.lead_time_days) AS delai_moyen,\n       COUNT(so.id) AS nombre_commandes,\n       AVG(CASE WHEN so.actual_delivery_date IS NOT NULL \n           THEN (so.actual_delivery_date - so.order_date) \n           ELSE NULL END) AS delai_reel_moyen\nFROM suppliers s\nJOIN supplier_orders so ON s.id = so.supplier_id\nWHERE so.order_date > (CURRENT_DATE - INTERVAL '1 year')\nGROUP BY s.id\nHAVING COUNT(so.id) >= 5\nORDER BY delai_reel_moyen ASC\nLIMIT 10"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel materiau coute le plus cher?"},{"role":"assistant","content":"Vous souhaitez savoir quels matériaux sont les plus coûteux ?\n\nIntention identifiée : Gestion des stocks - Analyse des coûts\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT m.id, m.name, m.description, m.unit, m.price,\n       m.quantity, (m.price * m.quantity) AS valeur_stock\nFROM materials m\nWHERE m.price > 0\nORDER BY m.price DESC\nLIMIT 15"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"trouve moi les projet avec depassement de budget"},{"role":"assistant","content":"Vous souhaitez identifier les projets qui ont dépassé leur budget ?\n\nIntention identifiée : Analyse financière - Dépassements budgétaires\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT p.id, p.name AS nom_projet, p.status,\n       CONCAT(c.firstname, ' ', c.lastname) AS client,\n       pb.total_budget AS budget_initial,\n       SUM(e.amount) AS depenses_totales,\n       (SUM(e.amount) - pb.total_budget) AS depassement,\n       ROUND(((SUM(e.amount) - pb.total_budget) / pb.total_budget) * 100, 2) AS pourcentage_depassement\nFROM projects p\nJOIN clients c ON p.client_id = c.id\nJOIN project_budgets pb ON p.id = pb.project_id\nJOIN expenses e ON p.id = e.project_id\nGROUP BY p.id, c.id, pb.id\nHAVING SUM(e.amount) > pb.total_budget\nORDER BY pourcentage_depassement DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel machine a besoin de maintenance?"},{"role":"assistant","content":"Vous souhaitez savoir quels équipements nécessitent une maintenance prochainement ?\n\nIntention identifiée : Gestion des équipements - Maintenance préventive\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT e.id, e.name, e.reference, ec.name AS categorie,\n       e.last_maintenance_date, e.next_maintenance_date,\n       CURRENT_DATE - e.next_maintenance_date AS jours_retard,\n       e.status, e.location\nFROM equipment e\nJOIN equipment_categories ec ON e.category_id = ec.id\nWHERE e.next_maintenance_date <= (CURRENT_DATE + INTERVAL '30 days')\nORDER BY e.next_maintenance_date ASC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel client na pas payé ses facture?"},{"role":"assistant","content":"Vous souhaitez identifier les clients qui ont des factures impayées ?\n\nIntention identifiée : Facturation et comptabilité - Suivi des impayés par client\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT c.id, CONCAT(c.firstname, ' ', c.lastname) AS client, c.email, c.phone,\n       COUNT(i.id) AS nombre_factures_impayees,\n       SUM(i.total_ttc) AS montant_total_impaye,\n       MIN(i.due_date) AS echeance_plus_ancienne,\n       MAX(CURRENT_DATE - i.due_date) AS jours_retard_max\nFROM clients c\nJOIN projects p ON c.id = p.client_id\nJOIN invoices i ON p.id = i.project_id\nWHERE i.status IN ('envoyée', 'en_retard')\n  AND i.due_date < CURRENT_DATE\nGROUP BY c.id\nORDER BY jours_retard_max DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est le CA par type de projet?"},{"role":"assistant","content":"Vous souhaitez connaître le chiffre d'affaires réparti par type de projet ?\n\nIntention identifiée : Analyse financière - Répartition du chiffre d'affaires\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    CASE \n        WHEN p.name ILIKE '%rénovation%' THEN 'Rénovation'\n        WHEN p.name ILIKE '%construction%' THEN 'Construction'\n        WHEN p.name ILIKE '%extension%' THEN 'Extension'\n        WHEN p.name ILIKE '%isolation%' THEN 'Isolation'\n        WHEN p.name ILIKE '%toiture%' THEN 'Toiture'\n        WHEN p.name ILIKE '%plomberie%' THEN 'Plomberie'\n        WHEN p.name ILIKE '%électricité%' THEN 'Électricité'\n        ELSE 'Autre'\n    END AS type_projet,\n    COUNT(p.id) AS nombre_projets,\n    SUM(i.total_ttc) AS chiffre_affaires,\n    ROUND(AVG(i.total_ttc), 2) AS montant_moyen\nFROM projects p\nJOIN invoices i ON p.id = i.project_id\nWHERE i.status = 'payée'\n  AND p.status = 'termine'\nGROUP BY type_projet\nORDER BY chiffre_affaires DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est le taux de conversion des devis?"},{"role":"assistant","content":"Vous souhaitez connaître le taux de conversion des devis en projets ?\n\nIntention identifiée : Analyse commerciale - Taux de conversion\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    EXTRACT(YEAR FROM q.created_date) AS annee,\n    EXTRACT(MONTH FROM q.created_date) AS mois,\n    COUNT(q.id) AS nombre_devis,\n    SUM(CASE WHEN q.status = 'accepté' THEN 1 ELSE 0 END) AS devis_acceptes,\n    SUM(CASE WHEN q.status = 'refusé' THEN 1 ELSE 0 END) AS devis_refuses,\n    SUM(CASE WHEN q.status = 'en_attente' THEN 1 ELSE 0 END) AS devis_en_attente,\n    ROUND((SUM(CASE WHEN q.status = 'accepté' THEN 1 ELSE 0 END)::float / COUNT(q.id)) * 100, 2) AS taux_conversion\nFROM quotations q\nWHERE q.created_date >= (CURRENT_DATE - INTERVAL '12 months')\nGROUP BY annee, mois\nORDER BY annee DESC, mois DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est le delai moyen de paiement des client?"},{"role":"assistant","content":"Vous souhaitez connaître le délai moyen de paiement des clients ?\n\nIntention identifiée : Facturation et comptabilité - Analyse des délais de paiement\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    CONCAT(c.firstname, ' ', c.lastname) AS client,\n    COUNT(i.id) AS nombre_factures,\n    ROUND(AVG(p.payment_date - i.issue_date), 1) AS delai_moyen_jours,\n    ROUND(AVG(p.payment_date - i.due_date), 1) AS ecart_echeance_jours,\n    SUM(i.total_ttc) AS montant_total,\n    MAX(p.payment_date) AS dernier_paiement\nFROM clients c\nJOIN projects pr ON c.id = pr.client_id\nJOIN invoices i ON pr.id = i.project_id\nJOIN payments p ON i.id = p.invoice_id\nWHERE i.status = 'payée'\n  AND i.issue_date >= (CURRENT_DATE - INTERVAL '1 year')\nGROUP BY c.id\nHAVING COUNT(i.id) >= 3\nORDER BY delai_moyen_jours DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est la charge de travail par employé ce mois?"},{"role":"assistant","content":"Vous souhaitez connaître la charge de travail de chaque employé pour le mois en cours ?\n\nIntention identifiée : Gestion des ressources humaines - Répartition de la charge de travail\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    s.id, CONCAT(s.firstname, ' ', s.lastname) AS employe, s.role,\n    COUNT(DISTINCT p.id) AS nombre_projets,\n    SUM(t.hours) AS heures_travaillees,\n    STRING_AGG(DISTINCT p.name, ', ') AS liste_projets,\n    ROUND(SUM(t.hours) / COUNT(DISTINCT t.date), 2) AS moyenne_heures_par_jour\nFROM staff s\nJOIN timesheet_entries t ON s.id = t.staff_id\nJOIN projects p ON t.project_id = p.id\nWHERE EXTRACT(MONTH FROM t.date) = EXTRACT(MONTH FROM CURRENT_DATE)\n  AND EXTRACT(YEAR FROM t.date) = EXTRACT(YEAR FROM CURRENT_DATE)\nGROUP BY s.id\nORDER BY heures_travaillees DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est le cout moyen par m2 des projet de renovation?"},{"role":"assistant","content":"Vous souhaitez connaître le coût moyen par mètre carré des projets de rénovation ?\n\nIntention identifiée : Analyse financière - Coûts unitaires\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    p.id, p.name, \n    CONCAT(c.firstname, ' ', c.lastname) AS client,\n    SUM(e.amount) AS cout_total,\n    (p.search_metadata->>'surface_m2')::numeric AS surface,\n    ROUND(SUM(e.amount) / (p.search_metadata->>'surface_m2')::numeric, 2) AS cout_par_m2\nFROM projects p\nJOIN clients c ON p.client_id = c.id\nJOIN expenses e ON p.id = e.project_id\nWHERE p.name ILIKE '%rénovation%'\n  AND p.status = 'termine'\n  AND p.search_metadata ? 'surface_m2'\n  AND (p.search_metadata->>'surface_m2')::numeric > 0\nGROUP BY p.id, c.id\nORDER BY cout_par_m2 ASC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel projet a utilisé le plus de materiaux?"},{"role":"assistant","content":"Vous souhaitez savoir quel projet a consommé le plus de matériaux ?\n\nIntention identifiée : Gestion des stocks - Consommation de matériaux par projet\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    p.id, p.name AS nom_projet, p.status,\n    CONCAT(c.firstname, ' ', c.lastname) AS client,\n    COUNT(DISTINCT pm.material_id) AS nombre_materiaux_differents,\n    SUM(pm.quantity) AS quantite_totale,\n    SUM(pm.quantity * pm.unit_price) AS cout_total_materiaux,\n    STRING_AGG(DISTINCT m.name, ', ' ORDER BY m.name) AS principaux_materiaux\nFROM projects p\nJOIN clients c ON p.client_id = c.id\nJOIN project_materials pm ON p.id = pm.project_id\nJOIN materials m ON pm.material_id = m.id\nGROUP BY p.id, c.id\nORDER BY quantite_totale DESC\nLIMIT 10"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel zone geografik a le plus de chantier?"},{"role":"assistant","content":"Vous souhaitez savoir dans quelle zone géographique se concentrent le plus de projets ?\n\nIntention identifiée : Analyse géographique - Répartition des projets\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    p.zip_code, p.city,\n    COUNT(p.id) AS nombre_projets,\n    COUNT(CASE WHEN p.status = 'en_cours' THEN 1 ELSE NULL END) AS projets_en_cours,\n    COUNT(CASE WHEN p.status = 'termine' THEN 1 ELSE NULL END) AS projets_termines,\n    SUM(i.total_ttc) AS chiffre_affaires_total\nFROM projects p\nLEFT JOIN invoices i ON p.id = i.project_id\nWHERE p.zip_code IS NOT NULL AND p.city IS NOT NULL\nGROUP BY p.zip_code, p.city\nORDER BY nombre_projets DESC\nLIMIT 15"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est le top 5 des produit les plus commandé?"},{"role":"assistant","content":"Vous souhaitez connaître les 5 produits les plus fréquemment commandés ?\n\nIntention identifiée : Gestion des achats - Produits les plus commandés\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    p.id, p.name AS produit, p.reference, pc.name AS categorie,\n    s.name AS fournisseur_principal,\n    COUNT(oi.id) AS nombre_commandes,\n    SUM(oi.quantity) AS quantite_totale,\n    SUM(oi.total_price) AS montant_total,\n    ROUND(AVG(oi.unit_price), 2) AS prix_moyen\nFROM products p\nJOIN product_categories pc ON p.category_id = pc.id\nJOIN suppliers s ON p.supplier_id = s.id\nJOIN order_items oi ON p.id = oi.product_id\nJOIN supplier_orders so ON oi.order_id = so.id\nWHERE so.order_date >= (CURRENT_DATE - INTERVAL '1 year')\nGROUP BY p.id, pc.id, s.id\nORDER BY nombre_commandes DESC, quantite_totale DESC\nLIMIT 5"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est la duré moyenne des chantier par type?"},{"role":"assistant","content":"Vous souhaitez connaître la durée moyenne des projets selon leur type ?\n\nIntention identifiée : Suivi de projet - Analyse des durées\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    CASE \n        WHEN p.name ILIKE '%rénovation%' THEN 'Rénovation'\n        WHEN p.name ILIKE '%construction%' THEN 'Construction'\n        WHEN p.name ILIKE '%extension%' THEN 'Extension'\n        WHEN p.name ILIKE '%isolation%' THEN 'Isolation'\n        WHEN p.name ILIKE '%toiture%' THEN 'Toiture'\n        WHEN p.name ILIKE '%plomberie%' THEN 'Plomberie'\n        WHEN p.name ILIKE '%électricité%' THEN 'Électricité'\n        ELSE 'Autre'\n    END AS type_projet,\n    COUNT(p.id) AS nombre_projets,\n    ROUND(AVG(p.end_date - p.start_date), 1) AS duree_moyenne_jours,\n    MIN(p.end_date - p.start_date) AS duree_min_jours,\n    MAX(p.end_date - p.start_date) AS duree_max_jours\nFROM projects p\nWHERE p.status = 'termine'\n  AND p.start_date IS NOT NULL\n  AND p.end_date IS NOT NULL\nGROUP BY type_projet\nORDER BY duree_moyenne_jours DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel client a le meilleur taux de conversion de devis?"},{"role":"assistant","content":"Vous souhaitez savoir quel client a le meilleur taux d'acceptation des devis ?\n\nIntention identifiée : Analyse commerciale - Taux de conversion par client\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    CONCAT(c.firstname, ' ', c.lastname) AS client,\n    COUNT(q.id) AS nombre_devis,\n    SUM(CASE WHEN q.status = 'accepté' THEN 1 ELSE 0 END) AS devis_acceptes,\n    ROUND((SUM(CASE WHEN q.status = 'accepté' THEN 1 ELSE 0 END)::float / COUNT(q.id)) * 100, 2) AS taux_conversion,\n    SUM(CASE WHEN q.status = 'accepté' THEN q.total ELSE 0 END) AS montant_total_accepte\nFROM clients c\nJOIN projects p ON c.id = p.client_id\nJOIN quotations q ON p.id = q.project_id\nGROUP BY c.id\nHAVING COUNT(q.id) >= 3\nORDER BY taux_conversion DESC, nombre_devis DESC\nLIMIT 10"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est le ratio de rentabilité par type de chantier?"},{"role":"assistant","content":"Vous souhaitez connaître le ratio de rentabilité pour chaque type de projet ?\n\nIntention identifiée : Analyse financière - Rentabilité par type de projet\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    CASE \n        WHEN p.name ILIKE '%rénovation%' THEN 'Rénovation'\n        WHEN p.name ILIKE '%construction%' THEN 'Construction'\n        WHEN p.name ILIKE '%extension%' THEN 'Extension'\n        WHEN p.name ILIKE '%isolation%' THEN 'Isolation'\n        WHEN p.name ILIKE '%toiture%' THEN 'Toiture'\n        WHEN p.name ILIKE '%plomberie%' THEN 'Plomberie'\n        WHEN p.name ILIKE '%électricité%' THEN 'Électricité'\n        ELSE 'Autre'\n    END AS type_projet,\n    COUNT(p.id) AS nombre_projets,\n    SUM(i.total_ttc) AS revenus_totaux,\n    SUM(e.amount) AS depenses_totales,\n    SUM(i.total_ttc - e.amount) AS marge_brute,\n    ROUND(AVG((i.total_ttc - e.amount) / NULLIF(i.total_ttc, 0) * 100), 2) AS taux_marge_moyen,\n    ROUND(SUM(i.total_ttc - e.amount) / SUM(i.total_ttc) * 100, 2) AS taux_marge_global\nFROM projects p\nJOIN invoices i ON p.id = i.project_id\nJOIN expenses e ON p.id = e.project_id\nWHERE p.status = 'termine'\nGROUP BY type_projet\nORDER BY taux_marge_global DESC"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel employé a le meilleur taux de satisfaction client?"},{"role":"assistant","content":"Vous souhaitez savoir quel membre du personnel obtient les meilleures évaluations de satisfaction client ?\n\nIntention identifiée : Gestion des ressources humaines - Évaluation des performances\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    s.id, CONCAT(s.firstname, ' ', s.lastname) AS employe, s.role,\n    COUNT(t.id) AS nombre_evaluations,\n    ROUND(AVG(t.rating), 2) AS note_moyenne,\n    COUNT(CASE WHEN t.rating = 5 THEN 1 ELSE NULL END) AS nombre_5_etoiles,\n    ROUND(COUNT(CASE WHEN t.rating = 5 THEN 1 ELSE NULL END)::float / COUNT(t.id) * 100, 2) AS pourcentage_5_etoiles\nFROM staff s\nJOIN project_staff ps ON s.id = ps.staff_id\nJOIN projects p ON ps.project_id = p.id\nJOIN testimonials t ON p.id = t.project_id\nWHERE ps.role = 'chef de projet'\n  AND t.is_published = true\nGROUP BY s.id\nHAVING COUNT(t.id) >= 3\nORDER BY note_moyenne DESC, nombre_evaluations DESC\nLIMIT 10"}]}
{"messages":[{"role":"system","content":"Vous êtes un assistant d'analyse pour une société de BTP spécialisée dans la construction et rénovation de bâtiments."},{"role":"user","content":"kel est le cout moyen des reparation des machine?"},{"role":"assistant","content":"Vous souhaitez connaître le coût moyen des réparations et maintenance des équipements ?\n\nIntention identifiée : Gestion des équipements - Analyse des coûts de maintenance\n\nAgent à utiliser : querybuilder\n\nType de requête : \nSELECT \n    ec.name AS categorie_equipement,\n    COUNT(DISTINCT e.id) AS nombre_equipements,\n    COUNT(mr.id) AS nombre_interventions,\n    ROUND(AVG(mr.cost), 2) AS cout_moyen_intervention,\n    SUM(mr.cost) AS cout_total,\n    MAX(mr.maintenance_date) AS derniere_intervention\nFROM equipment e\nJOIN equipment_categories ec ON e.category_id = ec.id\nJOIN maintenance_records mr ON e.id = mr.equipment_id\nWHERE mr.maintenance_date >= (CURRENT_DATE - INTERVAL '1 year')\nGROUP BY ec.id\nORDER BY cout_total DESC"}]}
